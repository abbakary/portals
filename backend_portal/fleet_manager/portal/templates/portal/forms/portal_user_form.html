<div class="section surface form-panel">
  <div class="section-header stacked">
    <div>
      <h2><i class="fa-solid fa-circle-user"></i> {% if is_create %}New portal profile{% else %}Edit portal profile{% endif %}</h2>
      <p class="muted">Define sign-in credentials and assign the correct application role.</p>
    </div>
    <div class="section-actions">
      <button class="btn" type="button" hx-get="{% url 'portal-users' %}" hx-target="#content">
        <i class="fa-solid fa-arrow-left"></i> Back to users
      </button>
    </div>
  </div>
  <form class="form form-portal" hx-post="{{ request.path }}" hx-target="#content">
    {% csrf_token %}
    {% if form.non_field_errors %}
    <div class="form-alert">
      <i class="fa-solid fa-triangle-exclamation"></i>
      <ul>
        {% for error in form.non_field_errors %}<li>{{ error }}</li>{% endfor %}
      </ul>
    </div>
    {% endif %}
    <div class="form-grid form-grid-3">
      <div class="field">
        {{ form.first_name.label_tag }}
        {{ form.first_name }}
        {% for error in form.first_name.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.last_name.label_tag }}
        {{ form.last_name }}
        {% for error in form.last_name.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.username.label_tag }}
        {{ form.username }}
        {% for error in form.username.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.email.label_tag }}
        {{ form.email }}
        {% for error in form.email.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.role.label_tag }}
        {{ form.role }}
        {% for error in form.role.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.phone_number.label_tag }}
        {{ form.phone_number }}
        {% for error in form.phone_number.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.organization.label_tag }}
        {{ form.organization }}
        {% for error in form.organization.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.job_title.label_tag }}
        {{ form.job_title }}
        {% for error in form.job_title.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field checkbox">
        {{ form.is_active }}
        <label for="{{ form.is_active.id_for_label }}">Active</label>
        {% for error in form.is_active.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
    </div>
    {% if is_create %}
    <div class="form-divider"></div>
    <h3 class="form-subtitle"><i class="fa-solid fa-lock"></i> Credentials</h3>
    <div class="form-grid form-grid-2">
      <div class="field">
        {{ form.password1.label_tag }}
        {{ form.password1 }}
        {% for error in form.password1.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
      <div class="field">
        {{ form.password2.label_tag }}
        {{ form.password2 }}
        {% for error in form.password2.errors %}<span class="field-error">{{ error }}</span>{% endfor %}
      </div>
    </div>
    {% endif %}
    <div class="actions">
      <button type="submit" class="btn btn-primary">
        <i class="fa-solid fa-floppy-disk"></i> Save profile
      </button>
      <button type="button" class="btn" hx-get="{% url 'portal-users' %}" hx-target="#content">
        Cancel
      </button>
    </div>
  </form>
</div>
